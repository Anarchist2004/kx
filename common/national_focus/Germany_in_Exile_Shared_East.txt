###########################
# Germany in Exile Eastern Focus Tree
# By Me
###########################

shared_focus = {
	id = GEX_war_in_the_east
	icon = GFX_goal_japan_helmet
	x = 0
	y = 0
	
	offset = {
		x = 4
		y = 8
		trigger = {
			tag = MAF
			NOT = { has_focus_tree = MAF-RFG }
		}
	}
	
	offset = {
		x = 46
		y = 0
		trigger = {
			tag = MAF
			has_focus_tree = MAF-RFG
		}
	}
	
	offset = {
		x = 40
		y = 0
		trigger = {
			tag = GEA
		}
	}
	
	offset = {
		x = 6
		y = 8
		trigger = {
			tag = AOG
		}
	} 
	
	cost = 8
	available = {
		OR = {
			has_global_flag = GER_became_GEX
			has_global_flag = GER_did_not_became_GEX
		}
		OR = {
			custom_trigger_tooltip = {
				tooltip = GEX_fled_to_us_tooltip
				GEX_fled_to_us = yes
			}
			AND = {
				tag = GEA
				has_country_flag = GEX_rejected_exiles
			}
		}
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		if = {
			limit = {
				AOG = { exists = no }
				GEA = { exists = no }
			}
			country_event = { id = GEX_foreign_east.1 }
		}
		add_political_power = 100
	}
}

shared_focus = {
	id = GEX_japan_wins_waaah
	icon = GFX_goal_align_japan
	x = -2
	y = 1
	
	cost = 8
	prerequisite = { focus = GEX_war_in_the_east }
	mutually_exclusive = {
		focus = GEX_kill_japan
	}
	relative_position_id = GEX_war_in_the_east
	available = {
		hidden_trigger = {
			always = no
		}
	}
	allow_branch = {
		NOT = {
			OR = {
				tag = GEA
				tag = AOG
			}
		}
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		#JAP = { country_event = { id = GEX_ days = 1 } }
	}
}

shared_focus = {
	id = GEX_cut_our_losses
	icon = GFX_goal_JAP_target_gea
	x = 0
	y = 1
	
	cost = 4
	prerequisite = { focus = GEX_japan_wins_waaah }
	relative_position_id = GEX_japan_wins_waaah
	available = {
		has_global_flag = GEX_Japan_concession_treaty
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		#GEA = { country_event = { id = GEX_ days = 1 } }
		#AOG = { country_event = { id = GEX_ days = 1 } }
	}
}

shared_focus = {
	id = GEX_lets_get_outta_ere
	icon = GFX_goal_generic_join_faction
	x = -1
	y = 1
	
	cost = 4
	prerequisite = { focus = GEX_cut_our_losses }
	relative_position_id = GEX_cut_our_losses
	available = {
		
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		add_manpower = 100000
	}
}

shared_focus = {
	id = GEX_you_forgot_the_guns_imbecile
	icon = GFX_focus_generic_military_equipment
	x = 0
	y = 1
	
	cost = 4
	prerequisite = { focus = GEX_lets_get_outta_ere }
	relative_position_id = GEX_lets_get_outta_ere
	available = {
		
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		random_owned_controlled_state = {
			limit = {
				ROOT = { has_full_control_of_state = PREV }
				is_core_of = ROOT
				free_building_slots = {
					building = arms_factory
					size > 0
					include_locked = yes
				}
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = arms_factory
				level = 1
				instant_build = yes
			}
		}
		if = {
			limit = {
				NOT = {
					GEA = { has_country_flag = GEX_rejected_exiles }
				}
			}
			random_owned_controlled_state = {
				limit = {
					ROOT = { has_full_control_of_state = PREV }
					is_core_of = ROOT
					free_building_slots = {
						building = arms_factory
						size > 1
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = arms_factory
					level = 2
					instant_build = yes
				}
			}
			else = {
				random_owned_controlled_state = {
					limit = {
						ROOT = { has_full_control_of_state = PREV }
						is_core_of = ROOT
						free_building_slots = {
							building = arms_factory
							size > 0
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = arms_factory
						level = 1
						instant_build = yes
					}
				}
			}
		}
		if = {
			limit = {
				GEA = {
					NOT = { has_country_flag = GEX_rejected_exiles }
					any_owned_state = {
						arms_factory > 1
					}
				}
			}
				GEA = {
				random_owned_state = {
					limit = {
						arms_factory > 1
					}
					remove_building = {
						type = arms_factory
						level = 2
					}
				}
			}
			else = {
				GEA = { add_ideas = GEX_fhak_your_mils }
			}
		}
		if = {
			limit = {
				NOT = {
					AOG = { has_country_flag = GEX_rejected_exiles }
				}
			}
			random_owned_controlled_state = {
				limit = {
					ROOT = { has_full_control_of_state = PREV }
					is_core_of = ROOT
					free_building_slots = {
						building = arms_factory
						size > 1
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = arms_factory
					level = 2
					instant_build = yes
				}
			}
			else = {
				random_owned_controlled_state = {
					limit = {
						ROOT = { has_full_control_of_state = PREV }
						is_core_of = ROOT
						free_building_slots = {
							building = arms_factory
							size > 0
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = arms_factory
						level = 1
						instant_build = yes
					}
				}
			}
		}
		if = {
			limit = {
				AOG = {
					NOT = { has_country_flag = GEX_rejected_exiles }
					any_owned_state = {
						arms_factory > 1
					}
				}
			}
			AOG = {
				random_owned_state = {
					limit = {
						arms_factory > 1
					}
					remove_building = {
						type = arms_factory
						level = 2
					}
				}
			}
			else = {
				AOG = { add_ideas = GEX_fhak_your_mils }
			}
		}
	}
}

shared_focus = {
	id = GEX_grab_da_monies
	icon = GFX_MAF_east_asian_exports
	x = 1
	y = 1
	
	cost = 4
	prerequisite = { focus = GEX_cut_our_losses }
	relative_position_id = GEX_cut_our_losses
	available = {
		
	}
	ai_will_do = {
		factor = 1000
	}

	completion_reward = {
		random_owned_controlled_state = {
			limit = {
				ROOT = { has_full_control_of_state = PREV }
				is_core_of = ROOT
				free_building_slots = {
					building = industrial_complex
					size > 0
					include_locked = yes
				}
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = industrial_complex
				level = 1
				instant_build = yes
			}
		}
		if = {
			limit = {
				NOT = {
					GEA = { has_country_flag = GEX_rejected_exiles }
				}
			}
			random_owned_controlled_state = {
				limit = {
					ROOT = { has_full_control_of_state = PREV }
					is_core_of = ROOT
					free_building_slots = {
						building = industrial_complex
						size > 1
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			else = {
				random_owned_controlled_state = {
					limit = {
						ROOT = { has_full_control_of_state = PREV }
						is_core_of = ROOT
						free_building_slots = {
							building = industrial_complex
							size > 0
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
				}
			}
		}
		if = {
			limit = {
				GEA = {
					NOT = { has_country_flag = GEX_rejected_exiles }
					any_owned_state = {
						industrial_complex > 1
					}
				}
			}
				GEA = {
				random_owned_state = {
					limit = {
						industrial_complex > 1
					}
					remove_building = {
						type = industrial_complex
						level = 2
					}
				}
			}
			else = {
				GEA = { add_ideas = GEX_fhak_your_civs }
			}
		}
		if = {
			limit = {
				NOT = {
					AOG = { has_country_flag = GEX_rejected_exiles }
				}
			}
			random_owned_controlled_state = {
				limit = {
					ROOT = { has_full_control_of_state = PREV }
					is_core_of = ROOT
					free_building_slots = {
						building = industrial_complex
						size > 1
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			else = {
				random_owned_controlled_state = {
					limit = {
						ROOT = { has_full_control_of_state = PREV }
						is_core_of = ROOT
						free_building_slots = {
							building = industrial_complex
							size > 0
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
				}
			}
		}
		if = {
			limit = {
				AOG = {
					NOT = { has_country_flag = GEX_rejected_exiles }
					any_owned_state = {
						industrial_complex > 1
					}
				}
			}
			AOG = {
				random_owned_state = {
					limit = {
						industrial_complex > 1
					}
					remove_building = {
						type = industrial_complex
						level = 2
					}
				}
			}
			else = {
				AOG = { add_ideas = GEX_fhak_your_civs }
			}
		}
	}
}

shared_focus = {
	id = GEX_grab_da_boats
	icon = GFX_goal_MAG_Navy_with_a_colony
	x = 0
	y = 1
	
	cost = 4
	prerequisite = { focus = GEX_grab_da_monies }
	relative_position_id = GEX_grab_da_monies
	available = {
		
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		random_owned_controlled_state = {
			limit = {
				ROOT = { has_full_control_of_state = PREV }
				is_core_of = ROOT
				free_building_slots = {
					building = dockyard
					size > 0
					include_locked = yes
				}
			}
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = dockyard
				level = 1
				instant_build = yes
			}
		}
		if = {
			limit = {
				NOT = {
					GEA = { has_country_flag = GEX_rejected_exiles }
				}
			}
			random_owned_controlled_state = {
				limit = {
					ROOT = { has_full_control_of_state = PREV }
					is_core_of = ROOT
					free_building_slots = {
						building = dockyard
						size > 1
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = dockyard
					level = 2
					instant_build = yes
				}
			}
			else = {
				random_owned_controlled_state = {
					limit = {
						ROOT = { has_full_control_of_state = PREV }
						is_core_of = ROOT
						free_building_slots = {
							building = dockyard
							size > 0
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = dockyard
						level = 1
						instant_build = yes
					}
				}
			}
		}
		if = {
			limit = {
				GEA = {
					NOT = { has_country_flag = GEX_rejected_exiles }
					any_owned_state = {
						dockyard > 1
					}
				}
			}
				GEA = {
				random_owned_state = {
					limit = {
						dockyard > 1
					}
					remove_building = {
						type = dockyard
						level = 2
					}
				}
			}
			else = {
				GEA = { add_ideas = GEX_fhak_your_dockyards }
			}
		}
		if = {
			limit = {
				NOT = {
					AOG = { has_country_flag = GEX_rejected_exiles }
				}
			}
			random_owned_controlled_state = {
				limit = {
					ROOT = { has_full_control_of_state = PREV }
					is_core_of = ROOT
					free_building_slots = {
						building = dockyard
						size > 1
						include_locked = yes
					}
				}
				add_extra_state_shared_building_slots = 2
				add_building_construction = {
					type = dockyard
					level = 2
					instant_build = yes
				}
			}
			else = {
				random_owned_controlled_state = {
					limit = {
						ROOT = { has_full_control_of_state = PREV }
						is_core_of = ROOT
						free_building_slots = {
							building = dockyard
							size > 0
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = dockyard
						level = 1
						instant_build = yes
					}
				}
			}
		}
		if = {
			limit = {
				AOG = {
					NOT = { has_country_flag = GEX_rejected_exiles }
					any_owned_state = {
						dockyard > 1
					}
				}
			}
			AOG = {
				random_owned_state = {
					limit = {
						dockyard > 1
					}
					remove_building = {
						type = dockyard
						level = 2
					}
				}
			}
			else = {
				AOG = { add_ideas = GEX_fhak_your_dockyards }
			}
		}
	}
}

shared_focus = {
	id = GEX_finalize_eastern_surrender
	icon = GFX_goal_generic_forceful_treaty
	x = 0
	y = 3
	
	cost = 4
	prerequisite = { focus = GEX_grab_da_boats }
	prerequisite = { focus = GEX_you_forgot_the_guns_imbecile }
	relative_position_id = GEX_cut_our_losses
	available = {
		
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		custom_effect_tooltip = 
		if = {
			limit = {
				NOT = {
					GEA = { has_country_flag = GEX_rejected_exiles }
				}
			}
			custom_effect_tooltip = 
		}
		else = {
			add_political_power
			custom_effect_tooltip = 
		}
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						GEA = { has_country_flag = GEX_rejected_exiles }
					}
				}
				every_state = {
					limit = {
						is_owned_by = GEA
					}
					set_state_flag = GEX_japan_treaty_concession_state
				}
				GEA = {
					every_unit_leader = {
						set_unit_leader_flag = GEX_exile_leader
						set_nationality = GEX
					}
				}
				annex_country = {
					target = GEA
					transfer_troops = yes
				}
			}
			else = {
				
			}
			if = {
				limit = {
					NOT = {
						AOG = { has_country_flag = GEX_rejected_exiles }
					}
				}
				every_state = {
					limit = {
						is_owned_by = AOG
					}
					set_state_flag = GEX_japan_treaty_concession_state
				}
				AOG = {
					every_unit_leader = {
						set_unit_leader_flag = GEX_exile_leader
						set_nationality = GEX
					}
				}
				annex_country = {
					target = AOG
					transfer_troops = yes
				}
			}
			every_state = {
				limit = {
					has_state_flag = GEX_japan_treaty_concession_state
				}
				JAP = {
					transfer_state = PREV
				}
			}
		}
	}
}

shared_focus = {
	id = GEX_kill_japan
	icon = GFX_focus_AST_war_japan
	x = 2
	y = 1
	
	offset = {
		x = -2
		y = 0
		trigger = {
			OR = {
				tag = GEA
				tag = AOG
			}
		}
	}
	
	cost = 8
	prerequisite = { focus = GEX_war_in_the_east }
	mutually_exclusive = {
		focus = GEX_japan_wins_waaah
	}
	relative_position_id = GEX_war_in_the_east
	available = {
		
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		every_country = {
			limit = { 
				in_faction_with = THIS
			}
			add_ideas = GEX_kill_japan_idea
		}
	}
}

shared_focus = {
	id = GEX_asia_gang
	icon = GFX_focus_ger_revive_kaiserreich
	x = 0
	y = 1
	
	cost = 8
	prerequisite = { focus = GEX_kill_japan }
	relative_position_id = GEX_kill_japan
	available = {
		
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		add_political_power = 50
		custom_effect_tooltip = GEX_asia_gang_tooltip
	}
}

shared_focus = {
	id = GEX_arm_the_east
	icon = GFX_goal_mittel_arms_trade
	x = -1
	y = 1
	
	offset = {
		x = -1
		y = 0
		trigger = {
			OR = {
				tag = GEA
				tag = AOG
			}
		}
	}
	
	cost = 8
	prerequisite = { focus = GEX_asia_gang }
	relative_position_id = GEX_asia_gang
	available = {
		
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		add_offsite_building = { type = arms_factory level = 1 }
		custom_effect_tooltip = GEX_arm_the_east_guns_tooltip
		hidden_effect = {
			GEA = {
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = 5000
					producer = GER
				}
			}
			AOG = {
				add_equipment_to_stockpile = {
					type = infantry_equipment
					amount = 5000
					producer = GER
				}
			}
		}
	}
}

shared_focus = {
	id = GEX_an_avenue_of_attack
	icon = GFX_focus_ger_revive_kaiserreich
	x = 0
	y = 1
	
	offset = {
		x = -1
		y = 0
		trigger = {
			OR = {
				tag = GEA
				tag = AOG
			}
		}
	}
	
	cost = 8
	prerequisite = { focus = GEX_arm_the_east }
	relative_position_id = GEX_arm_the_east
	available = {
		
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		#country_event = { id = GEX_ }
	}
}

shared_focus = {
	id = GEX_japan_war_a
	icon = GFX_focus_ger_revive_kaiserreich
	x = 1
	y = 1
	
	offset = {
		x = 1
		y = 0
		trigger = {
			OR = {
				tag = GEA
				tag = AOG
			}
		}
	}
	
	cost = 8
	prerequisite = { focus = GEX_asia_gang }
	relative_position_id = GEX_asia_gang
	available = {
		
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		add_political_power = 25
	}
}

shared_focus = {
	id = GEX_japan_war_b
	icon = GFX_focus_ger_revive_kaiserreich
	x = 0
	y = 1
	
	offset = {
		x = 1
		y = 0
		trigger = {
			OR = {
				tag = GEA
				tag = AOG
			}
		}
	}
	
	cost = 8
	prerequisite = { focus = GEX_japan_war_a }
	relative_position_id = GEX_japan_war_a
	available = {
		
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		add_political_power = 25
	}
}

shared_focus = {
	id = GEX_anticlimax
	icon = GFX_goal_generic_intelligence_exchange
	x = 0
	y = 3
	
	cost = 8
	prerequisite = { focus = GEX_japan_war_b }
	prerequisite = { focus = GEX_an_avenue_of_attack }
	relative_position_id = GEX_asia_gang
	available = {
		
	}
	ai_will_do = {
		factor = 1000
	}
	
	allow_branch = {
		NOT = {
			OR = {
				tag = GEA
				tag = AOG
			}
		}
	}
	
	completion_reward = {
		#event for offeirng Japan some shiet in exchange for autonomy/territory
	}
}

#Expanded tree focuses
shared_focus = {
	id = GEX_army_of_exile_east
	icon = GFX_focus_ger_oppose_hitler
	x = 0
	y = 1
	
	cost = 8
	prerequisite = { focus = GEX_asia_gang }
	relative_position_id = GEX_asia_gang
	available = {
		
	}
	allow_branch = {
		OR = {
			tag = GEA
			tag = AOG
		}
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		add_equipment_to_stockpile = {
			type = infantry_equipment_1
			amount = 5000
			producer = GER
		}
		add_manpower = 50000
		army_experience = 100
	}
}

shared_focus = {
	id = GEX_german_elites
	icon = GFX_focus_ger_return_of_the_kaiser
	x = -1
	y = 1
	
	cost = 8
	prerequisite = { focus = GEX_army_of_exile_east }
	mutually_exclusive = {
		focus = GEX_kaisers_own_men
	}
	relative_position_id = GEX_army_of_exile_east
	available = {
		OR = {
			has_completed_focus = GEA_germantroops1
			has_completed_focus = GEA_localtroops3
			tag = AOG
		}
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		effect_tooltip = {
			if = {
				limit = {
					tag = GEA
				}
				swap_ideas = {
					remove_idea = GEA_prussian_force
					add_idea = GEA_prussian_force_exilewaffen
				}
				custom_effect_tooltip = GEX_effect_or
				swap_ideas = {
					remove_idea = GEA_language
					add_idea = GEA_language_exilewaffen
				}
				else = {
					add_ideas = GEX_exilewaffen_idea
				}
			}
		
		
		}
		hidden_effect = {
			if = {
				limit = {
					has_completed_focus = GEA_germantroops1
				}
				swap_ideas = {
					remove_idea = GEA_prussian_force
					add_idea = GEA_prussian_force_exilewaffen
				}
			}
			else_if = {
				limit = {
					has_completed_focus = GEA_localtroops3
				}
				swap_ideas = {
					remove_idea = GEA_language
					add_idea = GEA_language_exilewaffen
				}
				else = {
					add_ideas = GEX_exilewaffen_idea
				}
			}
		}
		add_manpower = 50000
		add_war_support = 0.10
	}
}

shared_focus = {
	id = GEX_kaisers_own_men
	icon = GFX_focus_generic_military_academy
	x = 1
	y = 1
	
	cost = 8
	prerequisite = { focus = GEX_army_of_exile_east }
	mutually_exclusive = {
		focus = GEX_german_elites
	}
	relative_position_id = GEX_army_of_exile_east
	available = {
		OR = {
			has_completed_focus = GEA_germantroops1
			has_completed_focus = GEA_localtroops3
			tag = AOG
		}
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		effect_tooltip = {
			if = {
				limit = {
					tag = GEA
				}
				swap_ideas = {
					remove_idea = GEA_prussian_force
					add_idea = GEA_prussian_force_kaisers_own
				}
				custom_effect_tooltip = GEX_effect_or
				swap_ideas = {
					remove_idea = GEA_language
					add_idea = GEA_language_kaisers_own
				}
				else = {
					add_ideas = GEX_kaisers_own_idea
				}
			}
		
		
		}
		hidden_effect = {
			if = {
				limit = {
					has_completed_focus = GEA_germantroops1
				}
				swap_ideas = {
					remove_idea = GEA_prussian_force
					add_idea = GEA_prussian_force_kaisers_own
				}
			}
			else_if = {
				limit = {
					has_completed_focus = GEA_localtroops3
				}
				swap_ideas = {
					remove_idea = GEA_language
					add_idea = GEA_language_kaisers_own
				}
				else = {
					add_ideas = GEX_kaisers_own_idea
				}
			}
		}
		army_experience = 50
		add_stability = 0.10
	}
}

shared_focus = {
	id = GEX_anticlimax_redux
	icon = GFX_goal_generic_intelligence_exchange
	x = 0
	y = 3
	
	cost = 8
	prerequisite = { focus = GEX_german_elites focus = GEX_kaisers_own_men }
	prerequisite = { focus = GEX_japan_war_2 }
	prerequisite = { focus = GEX_japan_war_b }
	relative_position_id = GEX_asia_gang
	available = {
		
	}
	ai_will_do = {
		factor = 1000
	}
	
	completion_reward = {
		#event for offeirng Japan some shiet in exchange for autonomy/territory
	}
}